/*! jQuery REST Client - v0.0.5 - 2013-05-18
 * https://github.com/jpillora/jquery.rest
 * Copyright (c) 2013 Jaime Pillora; Licensed MIT */
(function(){"use strict";var t,e,n,r,i,s,o,a,h,u,l,c;o=function(t){throw"ERROR: jquery.rest: "+t},h=function(t){var e;for(e="";t-->0;)e+="  ";return e},s=function(t){return window.btoa||o("You need a polyfill for 'btoa' to use basic auth."),window.btoa(t)},u=function(t){return window.JSON||o("You need a polyfill for 'JSON' to use stringify."),window.JSON.stringify(t)},a=function(t,e){var n;return n=function(){},n.prototype=t,$.extend(!0,new n,e)},l=function(t){return t&&$.isPlainObject(t)?($.each(t,function(t){return void 0===r[t]?o("Unknown option: '"+t+"'"):void 0}),null):!1},c=function(t,e){return"string"!==$.type(e)?o("'"+t+"' must be a string"):void 0},i=function(){return alert('"delete()" has been deprecated. Please use "destroy()" or "del()" instead.')},r={url:"",cache:0,cachableMethods:["GET"],stringifyData:!1,stripTrailingSlash:!1,password:null,username:null,verbs:{create:"POST",read:"GET",update:"PUT",destroy:"DELETE"},ajax:{dataType:"json"}},t=function(){function t(t){this.parent=t,this.c={}}return t.prototype.valid=function(t){var e;return e=(new Date).getTime()-t.getTime(),1e3*this.parent.opts.cache>=e},t.prototype.key=function(t){var e,n=this;return e="",$.each(t,function(t,r){return e+=t+"="+($.isPlainObject(r)?"{"+n.key(r)+"}":r)+"|"}),e},t.prototype.get=function(t){var e;return(e=this.c[t])?this.valid(e.created)?e.data:void 0:void 0},t.prototype.put=function(t,e){return this.c[t]={created:new Date,data:e}},t.prototype.clear=function(t){var e=this;return t?$.each(this.c,function(n){return n.match(t)?delete e.c[n]:void 0}):this.c={}},t}(),n=function(){function t(t,e,n,i){this.name=t,this.method=e,null==n&&(n={}),this.parent=i,c("name",this.name),c("method",this.method),l(n),this.parent[this.name]&&o("Cannot add Verb: '"+t+"' already exists"),this.method=e.toUpperCase(),n.url||(n.url=""),this.opts=a(this.parent.opts,n),this.root=this.parent.root,this.custom=!r.verbs[this.name],this.call=$.proxy(this.call,this),this.call.instance=this}return t.prototype.call=function(){var t;return t=this.parent.extractUrlData(this.method,arguments),this.custom&&(t.url+=this.opts.url||this.name),this.parent.ajax.call(this,this.method,t.url,t.data)},t.prototype.show=function(t){return console.log(h(t)+this.name+": "+this.method)},t}(),e=function(){function e(t,n,r){null==n&&(n={}),l(n),r&&r instanceof e?(this.name=t,c("name",this.name),this.constructChild(r,n)):(this.url=t||"",c("url",this.url),this.constructRoot(n))}return e.prototype.constructRoot=function(e){return this.opts=a(r,e),this.root=this,this.numParents=0,this.urlNoId=this.url,this.cache=new t(this),this.parent=null,this.name=this.opts.name||"ROOT"},e.prototype.constructChild=function(t,n){return this.parent=t,c("name",this.name),this.parent instanceof e||this.error("Invalid parent"),this.parent[this.name]&&this.error("'"+name+"' already exists"),n.url||(n.url=""),this.opts=a(this.parent.opts,n),this.root=this.parent.root,this.numParents=this.parent.numParents+1,this.urlNoId=this.parent.url+(""+(this.opts.url||this.name)+"/"),this.url=this.urlNoId+(":ID_"+this.numParents+"/"),$.each(this.opts.verbs,$.proxy(this.addVerb,this)),this.destroy?(this.del=this.destroy,this["delete"]=i):void 0},e.prototype.error=function(t){return o("Cannot add Resource: "+t)},e.prototype.add=function(t,n){return this[t]=new e(t,n,this)},e.prototype.addVerb=function(t,e,r){return this[t]=new n(t,e,r,this).call},e.prototype.show=function(t){return null==t&&(t=0),t>25&&o("Plugin Bug! Recursion Fail"),this.name&&console.log(h(t)+this.name+": "+this.url),$.each(this,function(e,r){return"function"===$.type(r)&&r.instance instanceof n&&"del"!==e?r.instance.show(t+1):void 0}),$.each(this,function(n,r){return"parent"!==n&&"root"!==n&&r instanceof e?r.show(t+1):void 0}),null},e.prototype.toString=function(){return this.name},e.prototype.extractUrlData=function(t,e){var n,r,i,s,a,h,u,l,c,p,d,f,m,y,g;for(u=[],s=null,f=0,y=e.length;y>f;f++)n=e[f],p=$.type(n),"string"===p||"number"===p?u.push(n):$.isPlainObject(n)&&null===s?s=n:o("Invalid argument: "+n+" ("+p+")."+" Must be strings or ints (IDs) followed by one optional plain object (data).");for(c=u.length,r="create"!==t,i="update"!==t&&"delete"!==t,d=null,r&&c===this.numParents&&(d=this.url),i&&c===this.numParents-1&&(d=this.urlNoId),null===d&&(i&&(l=this.numParents-1),r&&(l=(l?l+" or ":"")+this.numParents),o("Invalid number of ID arguments, required "+l+", provided "+c)),a=m=0,g=u.length;g>m;a=++m)h=u[a],d=d.replace(RegExp("/:ID_"+(a+1)+"/"),"/"+h+"/");return{url:d,data:s}},e.prototype.ajax=function(t,e,n,r){var i,a,h,l,c,p=this;return null==r&&(r={}),t||o("method missing"),e||o("url missing"),this.opts.username&&this.opts.password&&(a=s(this.opts.username+":"+this.opts.password),r.Authorization="Basic "+a),n&&this.opts.stringifyData&&(n=u(n)),this.opts.stripTrailingSlash&&(e=e.replace(/\/$/,"")),i={url:e,type:t,headers:r},n&&(i.data=n),i=$.extend(!0,{},this.opts.ajax,i),c=this.opts.cache&&$.inArray(t,this.opts.cachableMethods)>=0,c&&(h=this.root.cache.key(i),l=this.root.cache.get(h))?l:(l=$.ajax(i),c&&l.done(function(){return p.root.cache.put(h,l)}),l)},e}(),e.defaults=r,$.RestClient=e}).call(this);